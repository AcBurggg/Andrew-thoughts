<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrew Thoughts</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" type="image/png" href="../images/favicon.png">
    <script type="text/javascript"
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
      <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
    }
    th, td {
      border: 1px solid #000000;
      padding: 0.5em;
      text-align: center;
    }
  </style>
</head>
<body>
    <header class="site-header">
        <a class="site-title" href="../index.html">Andrew's Thoughts</a>
    </header>
    <main class="subpage-content">
        <p class="subpage-title">Why XOR?</p>
        <div class="subpage-intro">
            <p>Over the past few months, I’ve been working a lot with ChaCha20, a symmetric encryption algorithm designed as a less-computationally intensive alternative to the AES algorithm on CPUs without dedicated hardware acceleration. This algorithm uses an add-rotate-XOR (ARX) block function in counter mode to generate a pseudorandom keystream. (My previous <a href="https://github.com/AcBurggg/chacha20_circuitSim" target="_blank"> post</a> links to a repository with an implementation of this block function in CircuitSim, an educational software used in courses like Organization & Programming and Systems & Networks at Georgia Tech.) Once generated, this keystream is simply XOR’d with a plaintext to produce the ciphertext. This asymmetry got me thinking. Why’s the complexity required to generate the keystream so much greater than that of the “actual encrypting”? And why did we choose to use XOR instead of one of the many other logic gates taught in an introductory digital logic course such as AND/OR/NAND/NOR?</p>
        </div>

    <h3>1. XOR is Reversible</h3>

      <p>The first benefit of using XOR comes from the fact that it is <a href="https://en.wikipedia.org/wiki/Involution_(mathematics)" target="_blank">involutory</a>. This means you can perform the same operation to both encrypt and decrypt. You don’t need two separate logical constructions. This property can be understood using the following assumptions (...which can be proven via truth table or boolean algebra if so desired... but you really don't have to do that #trustMe).</p>

      <ol>
        <li> \( A \oplus A = 0 \) (Anything XOR'd with itself is 0)</li>
        <li> \( A \oplus 0 = A \) (Anything XOR'd with 0 is itself)</li>
        <li> \( A \oplus (B \oplus C) = (A \oplus B) \oplus C \) (Order of operations does not matter in an expression of all XORs)</li>
      </ol>

      <p>We can prove that decryption using the same exact same XOR operation returns the original plaintext:</p>

      <p>
        \[
        \begin{aligned}
        C &:= P \oplus K \text{(definition of encryption)} \\
        C \oplus K &= (P \oplus K) \oplus K \\
                   &= P \oplus (K \oplus K) \\
                   &= P \oplus 0 \\
                   &= P
        \end{aligned}
        \]
      </p>

      <h3>2. Security Benefits</h3>

      <p>The second (and more interesting) benefit is the security that XOR provides.</p>

      <p>Let’s compare how XOR, AND, and OR behave for a single bit of plaintext and keystream:</p>

      <table>
        <thead>
          <tr>
            <th>Plaintext</th>
            <th>Keystream</th>
            <th>XOR Ciphertext</th>
            <th>AND Ciphertext</th>
            <th>OR Ciphertext</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
          <tr><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td></tr>
          <tr><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td></tr>
          <tr><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td></tr>
        </tbody>
      </table>

      <p>When sending messages over an insecure channel, we want to ensure that any eavesdropper who intercepts our ciphertext C should not be able to learn anything about plaintext P. In other words, if a bad actor knows that a given bit in our ciphertext is a 1 or 0, they should not be able to perform statistically better than chance in guessing the value of the corresponding plaintext bit. </p>

      <p>We define the following events:</p>
      <ul>
        <li><strong>A</strong>: plaintext bit is 1</li>
        <li><strong>B</strong>: ciphertext bit is 1</li>
      </ul>

      <p>Consider the following conditional probabilities calculated using the truth table depicted above:</p>

      <ul>
        <li><strong>For a cipher using OR to encrypt:</strong> \( P(A \mid B) = \frac{P(A \land B)}{P(B)} = \frac{2/4}{3/4} = \frac{2}{3} \)</li>
        <li><strong>For a cipher using AND to encrypt:</strong> \( P(A \mid B) = \frac{P(A \land B)}{P(B)} = \frac{1/4}{1/4} = 1 \)</li>
        <li><strong>For a cipher using XOR to encrypt:</strong> \( P(A \mid B) = \frac{P(A \land B)}{P(B)} = \frac{1/4}{2/4} = \frac{1}{2} \)</li>
      </ul>

      <p>With XOR and a <em>truly random keystream</em>, the ciphertext bits are statistically independent of the plaintext bits and reveal no new information. Given that the ciphertext bit is revealed to be a 1, there is exactly a 50% chance the plaintext bit was a 1. The same cannot be said for OR or AND.</p>

      <p>PS: the key to security with XOR ciphers is to NEVER reuse the keystream (or even chunks of the keystream). Doing so leaves you vulnerable to a known-plaintext attack in which your keystream (and consequently future plaintexts) can be revealed. The <a href="https://en.wikipedia.org/wiki/One-time_pad" target="_blank"> one-time-pad</a> is provably secure but only if it truly is used ONE TIME. </p>

      <h2>Thanks : )</h2>
        </div>
    </main>
    <footer class="site-footer">
        <p>Contact: andrewburgessgt@gmail.com</a></p>
        <p>LinkedIn: <a class="footer-contact-links" href="https://www.linkedin.com/in/andrew-c-burgess/" target="_blank">Andrew-C-Burgess</a></p>
        <p>GitHub: <a class="footer-contact-links" href="https://github.com/AcBurggg" target="_blank">AcBurggg</a></p>
      <a class="subpage-footer-return" href="../index.html">Back to Main</a>
    </footer>
</body>